---
import {
  Users,
  Lightbulb,
  Code,
  TrendingUp,
  MessageCircle,
} from "@lucide/astro";

interface Step {
  name: string;
  icon: string;
  description: string;
}

const steps: Step[] = [
  {
    name: "Community",
    icon: "users",
    description: "Connect with like-minded volunteers",
  },
  {
    name: "Ideas",
    icon: "lightbulb",
    description: "Share and develop new concepts",
  },
  {
    name: "Development",
    icon: "code",
    description: "Build and iterate on solutions",
  },
  {
    name: "Impact",
    icon: "trending-up",
    description: "Measure and celebrate results",
  },
  {
    name: "Engagement",
    icon: "message-circle",
    description: "Share knowledge and grow",
  },
];
---

<div class="circle-cycle-container py-8">
  <div class="relative w-full max-w-lg mx-auto aspect-square">
    <!-- Central Circle -->
    <div class="absolute inset-0 flex items-center justify-center z-10">
      <div
        class="central-hub w-28 h-28 md:w-36 md:h-36 bg-mango-green-dark rounded-full flex items-center justify-center text-white text-center shadow-xl"
      >
        <div>
          <span class="font-bold text-lg md:text-xl leading-tight block"
            >Our</span
          >
          <span class="font-bold text-lg md:text-xl leading-tight block"
            >Process</span
          >
        </div>
      </div>
    </div>

    <!-- Circular Path with Arrows -->
    <svg viewBox="0 0 400 400" class="w-full h-full absolute inset-0">
      <!-- Grey dashed circle - middle layer at r=150 -->
      <circle
        cx="200"
        cy="200"
        r="150"
        fill="none"
        stroke="#E5E2DC"
        stroke-width="2"
        stroke-dasharray="4 4"
        class="path-circle"></circle>

      <!-- Curved arrows between nodes -->
      <defs>
        <marker
          id="arrowCircle"
          markerWidth="8"
          markerHeight="8"
          refX="6"
          refY="4"
          orient="auto"
        >
          <path d="M0,0 L8,4 L0,8 L2,4 Z" fill="#8BBF72"></path>
        </marker>
      </defs>

      <!-- Green arrow paths - centered between hub and grey circle at r=110 -->
      <path
        d="M 275 115 A 110 110 0 0 1 305 200"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.1s;"></path>
      <path
        d="M 300 220 A 110 110 0 0 1 250 295"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.2s;"></path>
      <path
        d="M 235 300 A 110 110 0 0 1 165 295"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.3s;"></path>
      <path
        d="M 150 285 A 110 110 0 0 1 95 200"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.4s;"></path>
      <path
        d="M 100 180 A 110 110 0 0 1 140 115"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.5s;"></path>
      <path
        d="M 155 105 A 110 110 0 0 1 255 108"
        fill="none"
        stroke="#8BBF72"
        stroke-width="2.5"
        marker-end="url(#arrowCircle)"
        class="arrow-path"
        style="animation-delay: 0.6s;"></path>
    </svg>

    <!-- Node circles positioned around the circle -->
    <div class="node node-1" style="animation-delay: 0.1s;">
      <div class="node-circle">
        <Users class="w-6 h-6 md:w-8 md:h-8 text-mango-green-dark" />
      </div>
      <span class="node-label">Community</span>
    </div>

    <div class="node node-2" style="animation-delay: 0.2s;">
      <div class="node-circle">
        <Lightbulb class="w-6 h-6 md:w-8 md:h-8 text-mango-green-dark" />
      </div>
      <span class="node-label">Ideas</span>
    </div>

    <div class="node node-3" style="animation-delay: 0.3s;">
      <div class="node-circle">
        <Code class="w-6 h-6 md:w-8 md:h-8 text-mango-green-dark" />
      </div>
      <span class="node-label">Development</span>
    </div>

    <div class="node node-4" style="animation-delay: 0.4s;">
      <div class="node-circle">
        <TrendingUp class="w-6 h-6 md:w-8 md:h-8 text-mango-green-dark" />
      </div>
      <span class="node-label">Impact</span>
    </div>

    <div class="node node-5" style="animation-delay: 0.5s;">
      <div class="node-circle">
        <MessageCircle class="w-6 h-6 md:w-8 md:h-8 text-mango-green-dark" />
      </div>
      <span class="node-label">Engagement</span>
    </div>
  </div>

  <p class="text-center text-muted text-sm mt-6">
    Our continuous cycle of collaboration and growth
  </p>
</div>

<style>
  .node {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    opacity: 0;
    animation: nodePopIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  }

  /* Position nodes in a circle - on outer edge */
  .node-1 {
    top: 2%;
    left: 50%;
    transform: translateX(-50%);
  }
  .node-2 {
    top: 25%;
    right: 2%;
  }
  .node-3 {
    bottom: 15%;
    right: 10%;
  }
  .node-4 {
    bottom: 15%;
    left: 10%;
  }
  .node-5 {
    top: 25%;
    left: 2%;
  }

  .node-circle {
    width: 3.5rem;
    height: 3.5rem;
    background: white;
    border: 3px solid #5a8a4a;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(90, 138, 74, 0.2);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @media (min-width: 768px) {
    .node-circle {
      width: 4.5rem;
      height: 4.5rem;
    }
  }

  .node:hover .node-circle {
    transform: scale(1.15);
    box-shadow: 0 8px 24px rgba(90, 138, 74, 0.35);
    border-color: #4a7a3a;
    background: #f0f8ec;
  }

  .node-label {
    font-size: 0.75rem;
    font-weight: 600;
    color: #2d3a24;
    text-align: center;
    transition: color 0.2s ease;
  }

  @media (min-width: 768px) {
    .node-label {
      font-size: 0.875rem;
    }
  }

  .node:hover .node-label {
    color: #5a8a4a;
  }

  @keyframes nodePopIn {
    from {
      opacity: 0;
      transform: scale(0.5) translateX(-50%);
    }
    to {
      opacity: 1;
      transform: scale(1) translateX(-50%);
    }
  }

  .node-2,
  .node-3 {
    animation-name: nodePopInRight;
  }

  .node-4,
  .node-5 {
    animation-name: nodePopInLeft;
  }

  @keyframes nodePopInRight {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes nodePopInLeft {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .arrow-path {
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
    animation: drawArrow 0.8s ease-out forwards;
  }

  @keyframes drawArrow {
    to {
      stroke-dashoffset: 0;
    }
  }

  .path-circle {
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    animation: drawCircle 2s ease-out forwards;
  }

  @keyframes drawCircle {
    to {
      stroke-dashoffset: 0;
    }
  }

  .central-hub {
    animation: pulseHub 3s ease-in-out infinite;
  }

  @keyframes pulseHub {
    0%,
    100% {
      box-shadow: 0 0 0 0 rgba(90, 138, 74, 0.4);
    }
    50% {
      box-shadow: 0 0 0 15px rgba(90, 138, 74, 0);
    }
  }
</style>
