---
import { ArrowRight, ExternalLink } from '@lucide/astro';

interface BlogPost {
    title: string;
    publication: string;
    date: string;
    link: string;
    author?: string;
    imageUrl?: string;
}

interface Props {
    posts: BlogPost[];
    mediumUrl?: string;
}

const { posts, mediumUrl = 'https://medium.com/@cibmangotree' } = Astro.props;
const featuredPost = posts[0];
const otherPosts = posts.slice(1, 5);

// Default Medium placeholder images based on article themes
const defaultImages = [
    'https://miro.medium.com/v2/resize:fit:720/format:webp/1*vbHf1vAyBb2u4K1-RGtaYA.jpeg',
    'https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y3Yd9tOwuF_gy_s0aK3vsg.jpeg',
    'https://miro.medium.com/v2/resize:fit:720/format:webp/1*8Z_LSzL-b24jlX_g8e9k4A.png'
];
---

<div class="blog-featured">
    <!-- Featured Post with large image -->
    {featuredPost && (
        <a href={featuredPost.link} target="_blank" rel="noopener noreferrer" class="featured-card block mb-8">
            <article class="bg-mango-green-dark text-white relative overflow-hidden">
                <div class="flex flex-col md:flex-row">
                    <!-- Featured Image -->
                    <div class="md:w-2/5 h-48 md:h-auto relative overflow-hidden">
                        <img 
                            src={featuredPost.imageUrl || defaultImages[0]}
                            alt={featuredPost.title}
                            class="featured-image w-full h-full object-cover absolute inset-0"
                        />
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent to-mango-green-dark/50 md:block hidden"></div>
                    </div>
                    
                    <!-- Content -->
                    <div class="md:w-3/5 p-8 md:p-10 relative">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-mango-green-light/20 rounded-full -translate-y-1/2 translate-x-1/2"></div>
                        
                        <div class="relative z-10">
                            <span class="inline-block bg-mango-yellow text-text-primary text-xs font-bold px-3 py-1 mb-4">
                                FEATURED
                            </span>
                            <h3 class="font-display italic text-2xl md:text-3xl mb-4 leading-tight">
                                {featuredPost.title}
                            </h3>
                            {featuredPost.author && (
                                <p class="text-white/80 mb-4">By {featuredPost.author}</p>
                            )}
                            <div class="flex items-center gap-4 text-sm text-white/70">
                                <span>{featuredPost.publication}</span>
                                <span>•</span>
                                <span>{featuredPost.date}</span>
                            </div>
                            <div class="mt-6 inline-flex items-center gap-2 text-mango-yellow font-medium">
                                Read article
                                <ArrowRight class="w-4 h-4 arrow-icon" />
                            </div>
                        </div>
                    </div>
                </div>
            </article>
        </a>
    )}

    <!-- Other Posts Grid with thumbnails -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
        {otherPosts.map((post, index) => (
            <a 
                href={post.link} 
                target="_blank" 
                rel="noopener noreferrer" 
                class="blog-card block"
                style={`animation-delay: ${index * 0.1}s;`}
            >
                <article class="bg-background border border-border-color overflow-hidden h-full flex flex-col">
                    <!-- Thumbnail -->
                    <div class="h-32 overflow-hidden relative">
                        <img 
                            src={post.imageUrl || defaultImages[(index % 2) + 1]}
                            alt={post.title}
                            class="blog-image w-full h-full object-cover"
                        />
                        <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
                    </div>
                    
                    <!-- Content -->
                    <div class="p-5 flex-1 flex flex-col">
                        <h4 class="font-display italic text-lg text-text-primary mb-3 flex-1 line-clamp-2">
                            {post.title}
                        </h4>
                        <div class="flex items-center gap-3 text-sm text-text-muted">
                            <span class="font-medium text-mango-green-dark">{post.publication}</span>
                            <span>•</span>
                            <span>{post.date}</span>
                        </div>
                    </div>
                </article>
            </a>
        ))}
    </div>

    <!-- More Articles Button -->
    <div class="text-center">
        <a 
            href={mediumUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="more-btn inline-flex items-center gap-2 bg-white border-2 border-mango-green-dark text-mango-green-dark px-6 py-3 font-semibold"
        >
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                <path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z"/>
            </svg>
            More articles on Medium
            <ExternalLink class="w-4 h-4 arrow-icon" />
        </a>
    </div>
</div>

<style>
    .featured-card article {
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .featured-card:hover article {
        transform: translateY(-4px);
        box-shadow: 0 12px 32px rgba(90, 138, 74, 0.3);
    }

    .featured-image {
        transition: transform 0.5s ease;
    }

    .featured-card:hover .featured-image {
        transform: scale(1.05);
    }

    .featured-card .arrow-icon {
        transition: transform 0.3s ease;
    }

    .featured-card:hover .arrow-icon {
        transform: translateX(6px);
    }

    .blog-card {
        opacity: 0;
        animation: fadeInCard 0.5s ease-out forwards;
    }

    .blog-card article {
        transition: all 0.3s ease;
    }

    .blog-card:hover article {
        border-color: #5A8A4A;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(90, 138, 74, 0.1);
    }

    .blog-image {
        transition: transform 0.4s ease;
    }

    .blog-card:hover .blog-image {
        transform: scale(1.1);
    }

    @keyframes fadeInCard {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .more-btn {
        transition: all 0.3s ease;
    }

    .more-btn:hover {
        background-color: #5A8A4A;
        color: white;
        transform: translateY(-2px);
    }

    .more-btn .arrow-icon {
        transition: transform 0.3s ease;
    }

    .more-btn:hover .arrow-icon {
        transform: translate(2px, -2px);
    }

    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
