---
interface Term {
    term: string;
    definition: string;
}

interface Props {
    terms: Term[];
}

const { terms } = Astro.props;
---

<div class="glossary-accordion space-y-3">
    {terms.map((item, index) => (
        <div 
            class="accordion-item border border-border-color bg-white"
            style={`animation-delay: ${index * 0.05}s;`}
        >
            <button 
                class="accordion-trigger w-full flex items-center justify-between p-4 md:p-5 text-left"
                aria-expanded="false"
            >
                <span class="font-semibold text-text-primary">{item.term}</span>
                <svg class="accordion-icon w-5 h-5 text-mango-green-dark flex-shrink-0 ml-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </button>
            <div class="accordion-content hidden">
                <div class="px-4 md:px-5 pb-4 md:pb-5 pt-0">
                    <p class="text-text-muted leading-relaxed border-l-4 border-mango-green-light pl-4">
                        {item.definition}
                    </p>
                </div>
            </div>
        </div>
    ))}
</div>

<style>
    .accordion-item {
        opacity: 0;
        animation: fadeInAccordion 0.4s ease-out forwards;
        transition: all 0.3s ease;
    }

    .accordion-item:hover {
        border-color: #8BBF72;
    }

    .accordion-item.open {
        border-color: #5A8A4A;
        box-shadow: 0 4px 12px rgba(90, 138, 74, 0.1);
    }

    @keyframes fadeInAccordion {
        from {
            opacity: 0;
            transform: translateY(5px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .accordion-trigger {
        transition: background-color 0.2s ease;
    }

    .accordion-trigger:hover {
        background-color: #F8F6F2;
    }

    .accordion-icon {
        transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .accordion-item.open .accordion-icon {
        transform: rotate(180deg);
    }

    .accordion-content {
        overflow: hidden;
        transition: max-height 0.3s ease;
    }
</style>

<script>
    document.querySelectorAll('.accordion-trigger').forEach(button => {
        button.addEventListener('click', () => {
            const item = button.parentElement;
            const content = item?.querySelector('.accordion-content');
            const isOpen = item?.classList.contains('open');
            
            // Close all other items
            document.querySelectorAll('.accordion-item').forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.classList.remove('open');
                    otherItem.querySelector('.accordion-content')?.classList.add('hidden');
                    otherItem.querySelector('.accordion-trigger')?.setAttribute('aria-expanded', 'false');
                }
            });
            
            // Toggle current item
            if (isOpen) {
                item?.classList.remove('open');
                content?.classList.add('hidden');
                button.setAttribute('aria-expanded', 'false');
            } else {
                item?.classList.add('open');
                content?.classList.remove('hidden');
                button.setAttribute('aria-expanded', 'true');
            }
        });
    });
</script>
