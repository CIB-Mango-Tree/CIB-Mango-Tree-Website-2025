---
import Layout from "@layouts/Layout.astro";
import Footer from "@components/Footer.astro";
import Newsletter from "@components/Newsletter.astro";
import BlogFeatured from "@components/BlogFeatured.astro";
import GlossaryAccordion from "@components/GlossaryAccordion.astro";
import {
  ExternalLink,
  FileText,
  Database,
  BookOpen,
  Newspaper,
  HelpCircle,
} from "@lucide/astro";
import { cn } from "@utils/classMerge";
import blogImg1 from "@assets/blog/Mango_Placeholder_1.png";
import blogImg2 from "@assets/blog/Mango_Placeholder_2.png";
import blogImg3 from "@assets/blog/Mango_Placeholder_3.png";
import blogImg4 from "@assets/blog/Mango_Placeholder_4.png";

const researchPapers = [
  {
    title: "The Spread of True and False News Online",
    authors: "Vosoughi, Roy, and Aral",
    year: "2018",
    publication: "Science",
    link: "https://www.science.org/doi/10.1126/science.aap9559",
  },
  {
    title: "Bots and Automation over Twitter during the U.S. Election",
    authors: "Bessi and Ferrara",
    year: "2016",
    publication: "First Monday",
    link: "https://firstmonday.org/ojs/index.php/fm/article/view/7090",
  },
  {
    title: "Detecting Bots on Social Media",
    authors: "Ferrara et al.",
    year: "2016",
    publication: "Communications of the ACM",
    link: "https://dl.acm.org/doi/10.1145/2818717",
  },
  {
    title: "Inside Feed: Coordinated Inauthentic Behavior",
    authors: "Meta",
    year: "2018",
    publication: "Meta Newsroom",
    link: "https://about.fb.com/news/2018/12/inside-feed-coordinated-inauthentic-behavior/",
  },
  {
    title: "How CIB Continues on Social Platforms",
    authors: "Stanford Internet Observatory",
    year: "2022",
    publication: "SIO Report",
    link: "https://cyber.fsi.stanford.edu/io",
  },
  {
    title: "Disinformation and Fake News",
    authors: "DFRLab",
    year: "2023",
    publication: "Atlantic Council",
    link: "https://www.atlanticcouncil.org/programs/digital-forensic-research-lab/",
  },
];

const tools = [
  {
    name: "Botometer",
    description: "API for checking Twitter account bot scores.",
    link: "https://botometer.osome.iu.edu/",
    color: "bg-[#FFE099]",
  },
  {
    name: "Atlantic Council DFRLab",
    description: "Digital forensics research and disinformation tracking.",
    link: "https://www.atlanticcouncil.org/programs/digital-forensic-research-lab/",
    color: "bg-mango-green-light",
  },
  {
    name: "Global Disinformation Index",
    description: "Disinformation risk ratings for news sites.",
    link: "https://www.disinformationindex.org/",
    color: "bg-[#FFF5E6]",
  },
  {
    name: "OSINT Framework",
    description: "Open source intelligence tools collection.",
    link: "https://osintframework.com/",
    color: "bg-[#E5F7F8]",
  },
];

const datasets = [
  {
    name: "Stanford Internet Observatory Datasets",
    description: "Research datasets on information operations.",
    link: "https://cyber.fsi.stanford.edu/io",
    access: "Free",
    color: "bg-[#E5F7F8]",
  },
  {
    name: "Twitter Transparency Center",
    description: "State-backed information operations data.",
    link: "https://transparency.twitter.com/",
    access: "Free",
    color: "bg-[#FFE099]",
  },
  {
    name: "Pushshift Reddit Dataset",
    description: "Historical Reddit data for research.",
    link: "https://pushshift.io/",
    access: "API Required",
    color: "bg-white border border-border-color",
  },
  {
    name: "CrowdTangle (Meta)",
    description: "Facebook and Instagram public data.",
    link: "https://www.crowdtangle.com/",
    access: "Application Required",
    color: "bg-white border border-border-color",
  },
];

const blogPosts = [
  {
    title:
      "Behind the Screens: How Coordinated Inauthentic Behavior Shapes Online Narratives",
    publication: "Medium",
    date: "2025",
    link: "https://medium.com/@cibmangotree/behind-the-screens-how-coordinated-inauthentic-behavior-shapes-online-narratives-dae5bb2b5a18",
    author: "Helen Glover",
    imageUrl: blogImg1.src,
  },
  {
    title: "A Year of Community and Growth at CIB Mango Tree",
    publication: "Medium",
    date: "December 17, 2025",
    link: "https://medium.com/@cibmangotree/a-year-of-community-and-growth-at-cib-mango-tree-3c9a49383ceb",
    imageUrl: blogImg2.src,
  },
  {
    title: "Inauthentic Trends: Tracking Coordinated Campaigns",
    publication: "Medium",
    date: "June 11, 2025",
    link: "https://medium.com/@cibmangotree/inauthentic-trends-tracking-coordinated-campaigns-on-social-media-through-hashtag-usage-2d8015966ebd",
    imageUrl: blogImg3.src,
  },
  {
    title: "Meet the team using social media analysis for social change",
    publication: "Medium",
    date: "May 15, 2025",
    link: "https://medium.com/@cibmangotree/meet-the-team-using-social-media-analysis-as-a-tool-for-social-change-018009c889a8",
    imageUrl: blogImg4.src,
  },
];

const glossaryTerms = [
  {
    term: "APIs (Application Programming Interfaces)",
    definition:
      "Tools that allow different software programs to communicate with each other, often used to access data from social media platforms.",
  },
  {
    term: "Bot",
    definition:
      "An automated account that performs tasks on social media, often used to artificially amplify content or spread disinformation at scale.",
  },
  {
    term: "Coordinated Inauthentic Behavior (CIB)",
    definition:
      "Organized, malicious efforts to manipulate public opinion online through fake accounts or disinformation.",
  },
  {
    term: "Civic Tech",
    definition:
      "The use of technology to improve the relationship between citizens and their government.",
  },
  {
    term: "Scraping",
    definition:
      'The automated process of extracting data from websites using custom-built programs or tools called "scrapers."',
  },
  {
    term: "Command Line Interface (CLI)",
    definition:
      "A text-based interface that allows you to interact with software by typing commands.",
  },
];

const navItems = [
  { id: "understanding", label: "Understanding CIB", icon: "HelpCircle" },
  { id: "blog", label: "From Our Blog", icon: "Newspaper" },
  { id: "research", label: "Research Papers", icon: "FileText" },
  { id: "tools", label: "Additional Tools", icon: "BookOpen" },
  { id: "datasets", label: "Datasets", icon: "Database" },
  { id: "glossary", label: "Glossary", icon: "BookOpen" },
];
---

<Layout>
  <!-- Centered wrapper for nav + content -->
  <div class="flex justify-center">
    <div class="flex justify-center w-7xl">
      <!-- Sticky Left Navigation -->
      <aside class="hidden lg:flex lg:flex-col w-64 shrink-0">
        <nav class="sticky top-24 py-20">
          <h3
            class="text-xs font-bold uppercase tracking-widest text-muted mb-6"
          >
            On This Page
          </h3>
          <ul class="space-y-3">
            {
              navItems.map((item) => (
                <li>
                  <a
                    href={`#${item.id}`}
                    class="nav-link flex items-center gap-2 text-sm text-muted hover:text-mango-green-dark py-2 px-3 -mx-3 transition-colors"
                  >
                    {item.label}
                  </a>
                </li>
              ))
            }
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <section class="flex-container-wrapper flex-1 bg-background">
        <div class="flex-conatiner-main w-4xl">
          <h1
            class="font-bold text-4xl md:text-5xl lg:text-6xl mb-10 leading-tight"
          >
            Resources
          </h1>

          <p class="text-xl text-muted mb-16 leading-relaxed">
            Curated resources to help you understand coordinated inauthentic
            behavior, bot detection, and information integrity.
          </p>

          <!-- Understanding CIB - Now First -->
          <div id="understanding" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <HelpCircle class="w-8 h-8 text-mango-green-dark" />
              Understanding CIB
            </h2>

            <div class="bg-mango-yellow-light p-8 md:p-10">
              <p class="text-muted mb-8 leading-relaxed text-lg">
                Coordinated Inauthentic Behavior (CIB) refers to the use of fake
                accounts or automated tools to artificially amplify content,
                manipulate public discourse, or mislead users about who is
                behind certain messages. CIB campaigns can be domestic or
                foreign, and may target elections, public health discussions, or
                other civic topics.
              </p>
              <div class="flex flex-wrap gap-4">
                <span class="keyword-tag bg-white px-4 py-2 text-sm">
                  Bot Networks
                </span>
                <span class="keyword-tag bg-white px-4 py-2 text-sm">
                  Astroturfing
                </span>
                <span class="keyword-tag bg-white px-4 py-2 text-sm">
                  Sockpuppets
                </span>
                <span class="keyword-tag bg-white px-4 py-2 text-sm">
                  Troll Farms
                </span>
                <span class="keyword-tag bg-white px-4 py-2 text-sm">
                  Information Operations
                </span>
              </div>
            </div>
          </div>

          <!-- Blog Section - Now Second -->
          <div id="blog" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <Newspaper class="w-8 h-8 text-mango-green-dark" />
              From Our Blog
            </h2>
            <BlogFeatured posts={blogPosts} />
          </div>

          <!-- Research Papers - Compact 2-column grid -->
          <div id="research" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <FileText class="w-8 h-8 text-mango-green-dark" />
              Research Papers
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              {
                researchPapers.map((paper, i) => (
                  <a
                    href={paper.link}
                    target="_blank"
                    rel="noopener"
                    class="paper-card group bg-background-alt p-5 border-l-4 border-mango-green-dark hover:border-mango-yellow"
                  >
                    <h3 class="font-semibold mb-2 text-sm leading-tight group-hover:text-mango-green-dark transition-colors">
                      {paper.title}
                    </h3>
                    <p class="text-xs text-muted">
                      {paper.authors} ({paper.year}) Â· {paper.publication}
                    </p>
                    <span class="inline-flex items-center gap-1 text-xs text-mango-green-dark mt-3 opacity-0 group-hover:opacity-100 transition-opacity">
                      Read paper <ExternalLink class="w-3 h-3" />
                    </span>
                  </a>
                ))
              }
            </div>
          </div>

          <!-- Additional Tools Section -->
          <div id="tools" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <BookOpen class="w-8 h-8 text-mango-green-dark" />
              Additional Tools
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              {
                tools.map((tool) => (
                  <a
                    href={tool.link}
                    target="_blank"
                    rel="noopener"
                    class={`tool-card ${tool.color} p-6 block`}
                  >
                    <h3 class="font-bold text-lg mb-3">{tool.name}</h3>
                    <p class="text-muted text-sm mb-4">{tool.description}</p>
                    <span class="text-mango-green-dark font-semibold text-sm inline-flex items-center gap-1">
                      Visit site <ExternalLink class="w-3 h-3" />
                    </span>
                  </a>
                ))
              }
            </div>
          </div>

          <!-- Datasets Section -->
          <div id="datasets" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <Database class="w-8 h-8 text-mango-green-dark" />
              Datasets
            </h2>

            <p class="text-muted mb-8">
              Access social media datasets for research. Some require API access
              or applications.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              {
                datasets.map((dataset) => {
                  const datasetClasses: string = cn("text-xs px-2 py-1", {
                    "bg-mango-green-light text-mango-green-dark":
                      dataset.access === "Free",
                    "bg-mango-yellow-light text-muted":
                      dataset.access !== "Free",
                  });

                  return (
                    <a
                      href={dataset.link}
                      target="_blank"
                      rel="noopener"
                      class={`dataset-card ${dataset.color} p-6 block`}
                    >
                      <div class="flex justify-between items-start mb-3">
                        <h3 class="font-bold text-lg">{dataset.name}</h3>
                        <span class={datasetClasses}>{dataset.access}</span>
                      </div>
                      <p class="text-muted text-sm mb-4">
                        {dataset.description}
                      </p>
                      <span class="text-mango-green-dark font-semibold text-sm inline-flex items-center gap-1">
                        Access dataset
                        <ExternalLink class="w-3 h-3" />
                      </span>
                    </a>
                  );
                })
              }
            </div>
          </div>

          <!-- Glossary Section -->
          <div id="glossary" class="mb-20 scroll-mt-24">
            <h2 class="font-bold text-3xl mb-8 flex items-center gap-3">
              <BookOpen class="w-8 h-8 text-mango-green-dark" />
              Glossary of Terms
            </h2>
            <GlossaryAccordion terms={glossaryTerms} />
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- <Newsletter /> -->
  <Footer />
</Layout>

<style>
  .nav-link {
    position: relative;
  }

  .nav-link::before {
    content: "";
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 0;
    background-color: #5a8a4a;
    transition: height 0.2s ease;
  }

  .nav-link:hover::before,
  .nav-link.active::before {
    height: 100%;
  }

  .paper-card {
    transition: all 0.3s ease;
  }

  .paper-card:hover {
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }

  .tool-card,
  .dataset-card {
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .tool-card:hover,
  .dataset-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  }

  .keyword-tag {
    transition: all 0.2s ease;
  }

  .keyword-tag:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(90, 138, 74, 0.2);
  }

  .scroll-mt-24 {
    scroll-margin-top: 6rem;
  }
</style>

<script>
  // Highlight active nav item based on scroll position
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        const id = entry.target.getAttribute("id");
        const navLink = document.querySelector(`a[href="#${id}"]`);
        if (navLink) {
          if (entry.isIntersecting) {
            document
              .querySelectorAll(".nav-link")
              .forEach((link) =>
                link.classList.remove(
                  "active",
                  "text-mango-green-dark",
                  "font-semibold",
                ),
              );
            navLink.classList.add(
              "active",
              "text-mango-green-dark",
              "font-semibold",
            );
          }
        }
      });
    },
    { threshold: 0.2, rootMargin: "-100px 0px -50% 0px" },
  );

  document.querySelectorAll("[id]").forEach((section) => {
    if (section.classList.contains("scroll-mt-24")) {
      observer.observe(section);
    }
  });
</script>
